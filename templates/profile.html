{% include "header.html" %}

<style>
  .blur {
      filter: blur(5px);
  }

  #loading-bh {
      position: absolute;
      z-index: 999;
      top: 50%;
      color: var(--dark-color);
      left: 50%;
      display: none;
  }
</style>
<div class="spinner-border loading-bh" id="loading-bh">
  <span class="visually-hidden">Loading...</span>
</div>

<div class="card mb-5 m-4" style="background-color: transparent; border: 2px solid black;" id="main">
    <h5 class="card-header" style="color: #000;">Profile Details</h5>
    <!-- Account -->
    <div class="card-body">
      <form id="formAccountSettings" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
      <div class="d-flex align-items-start align-items-sm-center gap-4">
        {% if profile_pfp == 0 %}
        <img
            src="/static/assets-dash/img/avatars/{{p_letter}}.png"
            alt="user-avatar"
          class="d-block rounded"
          height="100"
          width="100"
          id="UploadedAvatar" />
        {% else %}
        <img
            src="{{profile_pfp}}"
            alt="user-avatar"
          class="d-block rounded"
          height="100"
          width="100"
          id="UploadedAvatar" />
        {% endif %}

        <input type="hidden" name="pfp_changed" value="False" id="pfp_changed">
        <div class="button-wrapper">
          <label for="upload" class="btn me-2 mb-4 btn_bh" tabindex="0">
            <span class="d-none d-sm-block">Upload new photo</span>
            <i class="bx bx-upload d-block d-sm-none"></i>
            <input
              type="file"
              id="upload"
              class="account-file-input"
              hidden
              name="pfp"
              accept="image/png, image/jpeg"
            />
          </label>
          <button type="button" class="btn btn-outline-dark account-image-reset mb-4">
            <i class="bx bx-reset d-block d-sm-none"></i>
            <span class="d-none d-sm-block">Reset</span>
          </button>

          <p class="mb-0" style="color: #000;">Allowed JPG, GIF or PNG. Max size of 800Kb</p>
        </div>

      </div>
    </div>
    <hr class="my-0" style="background-color: transparent;">
    <div class="card-body">
        <div class="row">
          <div class="mb-3 col-md-6">
            <label style="color: #000;" for="firstName" class="form-label"><b>First Name</b></label>
            <input
              class="form-control"
              type="text"
              id="firstName"
              name="first_name"
              value="{{first_name}}"
              autofocus
            />
          </div>
          <div class="mb-3 col-md-6">
            <label style="color: #000;" for="lastName" class="form-label"><b>Last Name</b></label>
            <input class="form-control" type="text" name="last_name" id="lastName" value="{{last_name}}" />
          </div>
          <div class="mb-3 col-md-6">
            <label style="color: #000;" for="email" class="form-label"><b>E-mail</b></label>
            <input
              class="form-control"
              type="text"
              id="email"
              name="email"
              value="{{email}}"
              readonly
            />
          </div>

        </div>
        <div class="mt-2">
          <button type="submit" id="save" class="btn me-2 btn_bh my-1">Save changes</button>
          <button type="reset" class="btn btn-outline-dark my-1">Cancel</button>
        </div>
      </form>
      <!-- {% if is_premium == True %}
      <div class="mt-3 mb-3 col-12">
            <hr style="color: var(--dark-color); padding-bottom: 3px;">
            <h4 style="color: var(--dark-color)"><b><u>Premium Info</u></b></h4>
            <h5 style="color: #000">Premium User from : <br><b>{{start_date}}</b></h5>
            <h5 style="color: #000">Premium end date : <br><b>{{end_date}}</b></h5>
            <h5 style="color: #000">Premium plan days : <br><b>{{plan}}</b></h5>

          </div>
          {% endif %} -->
    </div>
    <!-- /Account -->
</div>

<div class="card mb-5 m-4 mt-2" style="background-color: transparent; border: 2px solid black; color: #000;">
  <h5 class="card-header" style="color: #000;">Delete Account</h5>
  <div class="card-body">
    <div class="mb-3 col-12 mb-0">
      <div class="alert alert-danger">
        <h6 class="alert-heading fw-bold mb-1">Are you sure you want to delete your account?</h6>
        <p class="mb-0">Once you delete your account, there is no going back. Please be certain.</p>
      </div>
    </div>
    <button type="button" class="btn btn-danger deactivate-account" data-bs-toggle="modal" data-bs-target="#modalCenter">Delete Account</button>
  </div>
</div>
<div class="modal fade" id="modalCenter" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalCenterTitle">Delete Account</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger">
          <h6 class="alert-heading fw-bold mb-1">Are you sure you want to delete your account?</h6>
          <p class="mb-0">Once you delete your account, all your data will be permanently deleted and there is no going back. Please be certain.</p>
          <!-- <p class="mb-0">Once you delete your account, there is no going back. Please be certain.</p> -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <a href="{% url 'delete_acc' %}"><button type="button" class="btn btn-danger">Delete Account</button></a>
      </div>
    </div>
  </div>
</div>
<br><br><br><br>
<!-- Footer -->

<!-- / Footer -->
  <!-- Core JS -->
    <!-- build:js assets-dash/vendor/js/core.js -->
    <script src="/static/assets-dash/vendor/libs/jquery/jquery.js"></script>
    <script src="/static/assets-dash/vendor/libs/popper/popper.js"></script>
    <script src="/static/assets-dash/vendor/js/bootstrap.js"></script>
    <script src="/static/assets-dash/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="/static/assets-dash/vendor/js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->

    <!-- Main JS -->
    <script src="/static/assets-dash/js/main.js"></script>

    <!-- Page JS -->
    <script src="/static/assets-dash/js/pages-account-settings-account.js"></script>

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script>
      const submitBtn = document.getElementById('save');
      const loadingDiv = document.getElementById('loading-bh');
      const bhBody = document.getElementById('main');
      const form = document.getElementById('formAccountSettings');


      submitBtn.addEventListener('click', () => {
          if (form.checkValidity()) {
              loadingDiv.style.display = 'block';
              bhBody.classList.add('blur');
          } else {
              form.reportValidity();
          }
      });
  </script>
  </body>
</html>